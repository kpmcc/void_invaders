<!DOCTYPE html>
<html>
 <head>
   <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    canvas {
        border: 1px solid #d3d3d3;
        background-color: black;
    }
    </style>
  </head>
  <body onload="startGame()">

<!-- TODO - data:URL image embedding - https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URIs -->


  <script>
    var myGamePiece;

    // https://opengameart.org/content/assets-for-a-space-invader-like-game

    var alien = new Image();
    alien.src = "https://opengameart.org/sites/default/files/red_5.png";

    var img = new Image();
    img.src = "https://opengameart.org/sites/default/files/player_38.png";

    function startGame() {
        myGamePiece = new invader(50, 440, img);
        myGameAlien = new invader(50, 80, alien);
        myGameArea.start();
    }

    var myGameArea = {
        canvas : document.createElement("canvas"),
        start : function() {
            this.canvas.width = 448;
            this.canvas.height = 512;
            this.context = this.canvas.getContext("2d");
            document.body.insertBefore(this.canvas, document.body.childNodes[0]);
            this.interval = setInterval(updateGameArea, 20);
        },
        clear : function() {
            this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
        },

        update_text: function (x_pos) {
            this.context.font = "20px Arial";
            this.context.fillStyle = "white"
            this.context.fillText(x_pos.toString(), 400, 480);
        }
        
    }

    function invader(x, y, img) {
        this.x = x;
        this.y = y;
        this.img = img;
        this.update = function() {
            ctx = myGameArea.context;
            ctx.drawImage(this.img, this.x, this.y);
        }
    }

    
      var x_direction = 1;
      var alien_speed = 1;
      var max_x = 400;
      console.log(max_x)
      var min_x = 20;

    function updateGameArea() {

        myGameArea.clear();
        if (myGameAlien.x >= max_x) {
            myGameAlien.y += 20;
            x_direction = -1;
        }
        if (myGameAlien.x <= min_x) {
            myGameAlien.y += 20;
            x_direction = 1;
        }

        myGameAlien.x += (x_direction * alien_speed);
        //myGamePiece.x += 1;
        myGamePiece.update();
        myGameAlien.update();
        myGameArea.update_text(myGameAlien.x)
    }

    var movementIncrement = 5;

    window.addEventListener("keydown", event => {
        if (event.key == "w") {
            //myGamePiece.y -= movementIncrement;
        } else if (event.key == "s") {
            //myGamePiece.y += movementIncrement;
        } else if (event.key == "a") {
            myGamePiece.x -= movementIncrement;
        } else if (event.key == "d") {
            myGamePiece.x += movementIncrement;
        }
        if (myGamePiece.x < 0)
            myGamePiece.x = 0;
        if (myGamePiece.x > (myGameArea.canvas.width - 40))
            myGamePiece.x = (myGameArea.canvas.width - 40);

    });



    </script>
    </body>

    <!------------------------------->
    <!-- window.onload = function() { -->
    <!-- img.onload = function() { -->
    <!-- ctx.drawImage(img, 0, 0); -->
    <!--                           -->
    <!-- }                         -->
    <!------------------------------->

  </html>
